<!DOCTYPE html>
<html lang="hu">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Korzika 2026</title>

  <style>
    /* ===== RESET ===== */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    /* ===== BODY + BACKGROUND ===== */
    body {
      font-family: "Georgia", serif;
      background: url("assets/banner_home.jpg") center/cover no-repeat fixed;
      color: #f3f3f3;
    }

    /* ===== LAYOUT ===== */
    .page {
      min-height: 100vh;
    }

    /* ===== TOPBAR ===== */
    .topbar {
      background: rgba(10, 10, 10, 0.9);
      border-bottom: 1px solid #333;
    }

    .topbar .inner {
      max-width: 1100px;
      margin: auto;
      padding: 14px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .brand .title {
      font-size: 22px;
      font-weight: bold;
      color: #ffb300;
    }

    .brand .subtitle {
      font-size: 13px;
      opacity: 0.8;
    }

    /* ===== BUTTONS ===== */
    .btn {
      display: inline-block;
      text-decoration: none;
      padding: 10px 18px;
      border-radius: 18px;
      font-weight: bold;
      font-size: 14px;
      transition: background 0.2s ease, transform 0.15s ease;
      margin-right: 10px;
      margin-top: 8px;
    }

    .btn-accent {
      background: #ffb300;
      color: #111;
    }

    .btn-accent:hover {
      background: #ffca4d;
      transform: translateY(-1px);
    }

    /* GMaps NAV gomb (mintak√©pes k√©k) */
    .btn-nav {
      background: #2f6fe6;
      color: #fff;
      border: 0;
      box-shadow: 0 10px 22px rgba(0, 0, 0, 0.35);
    }

    .btn-nav:hover {
      background: #3a7bf0;
      transform: translateY(-1px);
    }

    /* Calimoto gomb (piros) */
    .btn-calimoto {
      background: #ff2b2b;
      color: #fff;
      border: 0;
      box-shadow: 0 10px 22px rgba(0, 0, 0, 0.35);
    }

    .btn-calimoto:hover {
      background: #ff4a4a;
      transform: translateY(-1px);
    }

    /* ===== CONTENT ===== */
    .container {
      max-width: 1100px;
      margin: 60px auto;
      padding: 0 20px;
    }

    /* K√âRT FINOM√çT√ÅS: ne legyen ennyire s√∂t√©t, mert a keret is s√∂t√©t√≠t */
    .card {
      background: rgba(0, 0, 0, 0.58);
      border-radius: 18px;
      padding: 28px;
      box-shadow: 0 0 40px rgba(0, 0, 0, 0.6);
    }

    .h1 {
      font-size: 28px;
      margin-bottom: 12px;
    }

    .p {
      line-height: 1.6;
      opacity: 0.9;
    }

    /* ===== GRID ===== */
    .grid {
      margin-top: 26px;
    }

    .poi {
      background: linear-gradient(180deg, #111, #050505);
      border-radius: 16px;
      padding: 22px;
      border: 1px solid #222;
      margin-bottom: 18px;
    }

    .poi-head {
      display: flex;
      justify-content: space-between;
      gap: 20px;
      flex-wrap: wrap;
    }

    .poi-title {
      font-size: 20px;
      font-weight: bold;
    }

    .coords {
      font-size: 14px;
      opacity: 0.85;
      line-height: 1.45;
    }

    .coords b {
      color: #ffb300;
      font-weight: bold;
    }

    /* ===== POI BUTTONS ===== */
    .poibtns {
      margin-top: 18px;
    }

    /* ===== TOUR MAP (BOTTOM) ===== */
    .tourmap-section {
      margin-top: 26px;
      padding-top: 18px;
      border-top: 1px solid rgba(255, 255, 255, 0.12);
    }

    .tourmap-title {
      font-size: 18px;
      font-weight: bold;
      margin-bottom: 12px;
      opacity: 0.95;
    }

    .tourmap-wrap {
      position: relative;
      width: 100%;
      border-radius: 16px;
      overflow: hidden;
      border: 1px solid #222;
      background: #050505;
      box-shadow: 0 0 24px rgba(0, 0, 0, 0.45);
    }

    .tourmap-img {
      display: block;
      width: 100%;
      height: auto;
      user-select: none;
      -webkit-user-drag: none;
    }

    .tourmap-marker {
      position: absolute;
      left: 0;
      top: 0;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: #ff2b2b;
      border: 2px solid rgba(255, 255, 255, 0.95);
      box-shadow: 0 0 18px rgba(255, 43, 43, 0.9);
      transform: translate(-50%, -50%);
      pointer-events: none;
      display: none;
    }

    .tourmap-note {
      margin-top: 12px;
      font-size: 13px;
      opacity: 0.85;
      line-height: 1.45;
    }

    .tourmap-note b {
      color: #ffb300;
    }
  </style>
</head>

<body>
  <div class="page">

    <!-- TOPBAR -->
    <div class="topbar">
      <div class="inner">
        <div class="brand">
          <div class="title">Korzika 2026</div>
          <div class="subtitle">F≈ëoldal</div>
        </div>
      </div>
    </div>

    <!-- CONTENT -->
    <div class="container">
      <div class="card">

        <div class="h1">√ötiterv</div>

        <div class="p">
          Itt az √∂t nap bel√©p≈ë oldala van. Minden napon bel√ºl van lista n√©zet,
          √©s minden helysz√≠nnek k√ºl√∂n oldala.
        </div>

        <div class="grid">

          <!-- DAY01 -->
          <div class="poi">
            <div class="poi-head">
              <div>
                <div class="poi-title">1. nap ¬∑ Castagniccia, Corte, Ponte Novu</div>
                <div class="coords">
                  <b>15 meg√°ll√≥</b><br>
                  <b>200km</b><br>
                  <b>6351m emelked√©s</b> <b>6345m ereszked√©s</b><br>
                  A Scala di Santa Regina szurdoka ut√°n Corte t√∂rt√©nelmi magja adja a nap gerinc√©t, majd a Castagniccia barokk √©s f√ºggetlens√©gt√∂rt√©neti pontjai k√∂vetkeznek. A Ponte Novu csatat√©rn√©l a t√°j csendje k√ºl√∂n√∂sen er≈ës kontraszt a t√∂rt√©nelmi s√∫llyal.
                </div>
              </div>
            </div>

            <div class="poibtns">
              <a class="btn btn-accent" href="day01/index.html">Megnyit√°s</a>
              <a class="btn btn-nav" target="_blank"
                href="https://www.google.com/maps/dir/?api=1&origin=42.346651,9.013368&destination=42.346651,9.013368&waypoints=42.358658,9.05998%7C42.30528,9.151193%7C42.304682,9.148414%7C42.303878,9.148548%7C42.27909033428401,9.412401967285973%7C42.376305,9.377361%7C42.374717,9.367915%7C42.382106,9.365654%7C42.423162,9.352895%7C42.427498,9.331423%7C42.437816,9.309002%7C42.435036,9.298189%7C42.463131,9.315195%7C42.4866,9.2812%7C42.487734,9.281473">üß≠ GMaps navig√°ci√≥</a>
              <a class="btn btn-calimoto" target="_blank"
                href="https://calimoto.com/calimotour/1.-korzika-2026--r-BQF4CTfR8s">üèçÔ∏è Calimoto navig√°ci√≥</a>
            </div>
          </div>

          <!-- DAY02 -->
          <div class="poi">
            <div class="poi-head">
              <div>
                <div class="poi-title">2. nap ¬∑ Bastia, Cap Corse, Saint Florent, Niolo</div>
                <div class="coords">
                  <b>10 meg√°ll√≥</b><br>
                  <b>304km</b><br>
                  <b>7298m emelked√©s</b> <b>7277m ereszked√©s</b><br>
                  Bastia r√©gi kik√∂t≈ëj√©t≈ël a Cap Corse gerinc√©nek tornyaiig gyorsan fel√©p√ºl a tengeri karakter, Nonza sziklap√°rk√°nya pedig ikonikus kontraszt. A Teghime h√°g√≥ ut√°n Murato rom√°n temploma ritmusv√°lt√°s, a nap v√©g√©re Lozzi m√°r hegyvid√©ki b√°zis hangulat.
                </div>
              </div>
            </div>

            <div class="poibtns">
              <a class="btn btn-accent" href="day02/index.html">Megnyit√°s</a>
              <a class="btn btn-nav" target="_blank"
                href="https://www.google.com/maps/dir/?api=1&origin=42.346651,9.013368&destination=42.346651,9.013368&waypoints=42.695411,9.449519%7C42.774262,9.47636%7C42.905365,9.3728%7C42.68285,9.301656%7C42.679818,9.302238%7C42.6280844,9.3561684%7C42.67712,9.38276%7C42.5416879,9.2976771">üß≠ GMaps navig√°ci√≥</a>
              <a class="btn btn-calimoto" target="_blank"
                href="https://calimoto.com/calimotour/2.-korzika-2026-r-s4vsniB8f0">üèçÔ∏è Calimoto navig√°ci√≥</a>
            </div>
          </div>

          <!-- DAY03 -->
          <div class="poi">
            <div class="poi-head">
              <div>
                <div class="poi-title">3. nap ¬∑ Balagne, Calvi, Porto, Vergio, Niolo</div>
                <div class="coords">
                  <b>12 meg√°ll√≥</b><br>
                  <b>275km</b><br>
                  <b>6592m emelked√©s</b> <b>6590m ereszked√©s</b><br>
                  A Paoli alap√≠totta √éle Rousse √©s a Calvi citadella ut√°n a nyugati part UNESCO t√°jai viszik a f≈ëszerepet, Porto √©s a Spelunca szurdok l√°tv√°ny√°val. A Vergio k√∂rny√©ki magashegyi r√©teg √©s a Christ Roi szobor m√°r el≈ëk√©sz√≠ti a Niolo fenns√≠k h≈±v√∂sebb vil√°g√°t.
                </div>
              </div>
            </div>

            <div class="poibtns">
              <a class="btn btn-accent" href="day03/index.html">Megnyit√°s</a>
              <a class="btn btn-nav" target="_blank"
                href="https://www.google.com/maps/dir/?api=1&origin=42.346651,9.013368&destination=42.568253,8.760439&waypoints=42.5562767,9.0582241%7C42.59334,9.048421%7C42.635741,8.938554%7C42.599313,8.902105%7C42.58233,8.897603%7C42.58897,8.905409">üß≠ GMaps navig√°ci√≥ 1</a>
              <a class="btn btn-nav" target="_blank"
                href="https://www.google.com/maps/dir/?api=1&origin=42.568253,8.760439&destination=42.346651,9.013368&waypoints=42.552313,8.73673%7C42.423234,8.723949%7C42.266531,8.705166%7C42.251334,8.761211%7C42.290453,8.87833">üß≠ GMaps navig√°ci√≥ 2</a>
              <a class="btn btn-calimoto" target="_blank"
                href="https://calimoto.com/calimotour/3.-korzika-2023-r-pDy5WIBTHm">üèçÔ∏è Calimoto navig√°ci√≥</a>
            </div>
          </div>

          <!-- DAY04 -->
          <div class="poi">
            <div class="poi-head">
              <div>
                <div class="poi-title">4. nap ¬∑ Niolo, Calacuccia t√≥, Asco v√∂lgy, Haut Asco</div>
                <div class="coords">
                  <b>16 meg√°ll√≥</b><br>
                  <b>187km</b><br>
                  <b>5398m emelked√©s</b> <b>5394m ereszked√©s</b><br>
                  A Calacuccia g√°t √©s a Scala di Santa Regina szurdok m≈±szaki √©s t√°ji √©rtelemben is nagy napkezd√©s, ut√°na az Asco v√∂lgy sz≈±k√ºletei adj√°k a technik√°s motoros √©lm√©nyt. A genovai k≈ëh√≠d √©s Haut Asco alpesi tere m√°r a Monte Cinto t√∂meg√©nek k√∂zvetlen k√∂zels√©ge.
                </div>
              </div>
            </div>

            <div class="poibtns">
              <a class="btn btn-accent" href="day04/index.html">Megnyit√°s</a>
              <a class="btn btn-nav" target="_blank"
                href="https://www.google.com/maps/dir/?api=1&origin=42.346651,9.013368&destination=42.465,9.102&waypoints=42.334361,9.019304%7C42.35831,9.05857%7C42.3883538,9.2868123%7C42.437817,9.309028%7C42.462267,9.206204%7C42.477176,9.185817">üß≠ GMaps navig√°ci√≥ 1</a>
              <a class="btn btn-nav" target="_blank"
                href="https://www.google.com/maps/dir/?api=1&origin=42.465,9.102&destination=42.346651,9.013368&waypoints=42.452898,9.032729%7C42.4468195,9.0314827%7C42.437039,8.995992%7C42.424618,8.965808%7C42.403298,8.921027">üß≠ GMaps navig√°ci√≥ 2</a>
              <a class="btn btn-calimoto" target="_blank"
                href="https://calimoto.com/calimotour/4.-korzika-2026-r-iphkKiv9zZ">üèçÔ∏è Calimoto navig√°ci√≥</a>
            </div>
          </div>

          <!-- DAY05 -->
          <div class="poi">
            <div class="poi-head">
              <div>
                <div class="poi-title">5. nap ¬∑ Keleti part, Solenzara, Bavella h√°g√≥, Zonza</div>
                <div class="coords">
                  <b>15 meg√°ll√≥</b><br>
                  <b>340km</b><br>
                  <b>9903m emelked√©s</b> <b>9875m ereszked√©s</b><br>
                  A bels≈ë hegyvid√©kr≈ël a D√©fil√© de l‚ÄôInzecca √©s a Sampolo t√≥ hozza le az √∫tvonalat a keleti s√≠kra, majd Solenzara ut√°n visszafordul a hegyekbe. A Bavella h√°g√≥ √©s a t≈±k dr√°mai sziluettje a nap vizu√°lis cs√∫cspontja, Zonza pedig stabil b√°zis a magashegyi hangulat ut√°n.
                </div>
              </div>
            </div>

            <div class="poibtns">
              <a class="btn btn-accent" href="day05/index.html">Megnyit√°s</a>
              <a class="btn btn-nav" target="_blank"
                href="https://www.google.com/maps/dir/?api=1&origin=42.346651,9.013368&destination=41.7509696,9.17174&waypoints=42.0968251,9.3059395%7C42.095575,9.281474%7C41.910946,9.388454%7C41.858166,9.402219%7C41.833717,9.313208%7C41.795841,9.224671">üß≠ GMaps navig√°ci√≥ 1</a>
              <a class="btn btn-nav" target="_blank"
                href="https://www.google.com/maps/dir/?api=1&origin=41.7509696,9.17174&destination=42.346651,9.013368&waypoints=41.9175533,9.1343541%7C42.100623,9.210653%7C42.144107,9.1904057%7C42.172115,9.17106%7C42.193181,9.16763">üß≠ GMaps navig√°ci√≥ 2</a>
              <a class="btn btn-calimoto" target="_blank"
                href="https://calimoto.com/calimotour/5.-korzika-2026-r-Ma6rAt8Teg">üèçÔ∏è Calimoto navig√°ci√≥</a>
            </div>
          </div>

        </div>

        <!-- TOUR MAP BOTTOM -->
        <div class="tourmap-section">
          <div class="tourmap-title">Teljes t√∫ra t√©rk√©p (aktu√°lis poz√≠ci√≥ jel√∂l√©ssel)</div>

          <div class="tourmap-wrap" id="tourMapWrap">
            <img class="tourmap-img" id="tourMapImg" src="assets/Foldal_terkepn√©zet.png" alt="Korzika 2026 teljes t√©rk√©p">
            <div class="tourmap-marker" id="tourMarker" aria-hidden="true"></div>
          </div>

          <div class="tourmap-note" id="tourMapNote">
            <b>Megjegyz√©s:</b> a piros jel√∂l≈ë a b√∂ng√©sz≈ë helymeghat√°roz√°sa alapj√°n jelenik meg. Ha a helymeghat√°roz√°s tiltva van, a jel√∂l≈ë nem fog l√°tszani.
          </div>
        </div>

      </div>
    </div>

  </div>

  <script>
    (function () {
      const img = document.getElementById("tourMapImg");
      const marker = document.getElementById("tourMarker");
      const note = document.getElementById("tourMapNote");

      const controlPoints = [
        { name: "Zonza", lat: 41.750806, lon: 9.174782, x: 446, y: 534 },
        { name: "Lozzi", lat: 42.347554, lon: 9.019212, x: 1095, y: 393 },
        { name: "Nyugati part pont", lat: 42.326667, lon: 8.635438, x: 1073, y: 82 },
        { name: "Cap Corse pont", lat: 42.976269, lon: 9.382087, x: 1799, y: 670 },
        { name: "Bels≈ë pont", lat: 42.397793, lon: 8.920860, x: 1153, y: 315 },
        { name: "Solenzara k√∂rny√©ke", lat: 41.865698, lon: 9.396649, x: 575, y: 718 }
      ];

      function clamp(v, min, max) {
        return Math.max(min, Math.min(max, v));
      }

      function invert3x3(m) {
        const a = m[0][0], b = m[0][1], c = m[0][2];
        const d = m[1][0], e = m[1][1], f = m[1][2];
        const g = m[2][0], h = m[2][1], i = m[2][2];

        const A = (e * i - f * h);
        const B = -(d * i - f * g);
        const C = (d * h - e * g);
        const D = -(b * i - c * h);
        const E = (a * i - c * g);
        const F = -(a * h - b * g);
        const G = (b * f - c * e);
        const H = -(a * f - c * d);
        const I = (a * e - b * d);

        const det = a * A + b * B + c * C;
        if (Math.abs(det) < 1e-12) return null;

        const invDet = 1 / det;
        return [
          [A * invDet, D * invDet, G * invDet],
          [B * invDet, E * invDet, H * invDet],
          [C * invDet, F * invDet, I * invDet]
        ];
      }

      function mulMat3Vec3(m, v) {
        return [
          m[0][0] * v[0] + m[0][1] * v[1] + m[0][2] * v[2],
          m[1][0] * v[0] + m[1][1] * v[1] + m[1][2] * v[2],
          m[2][0] * v[0] + m[2][1] * v[1] + m[2][2] * v[2]
        ];
      }

      function transpose(A) {
        const r = A.length, c = A[0].length;
        const T = [];
        for (let j = 0; j < c; j++) {
          const row = [];
          for (let i = 0; i < r; i++) row.push(A[i][j]);
          T.push(row);
        }
        return T;
      }

      function mul(A, B) {
        const r = A.length, k = A[0].length, c = B[0].length;
        const out = Array.from({ length: r }, () => Array(c).fill(0));
        for (let i = 0; i < r; i++) {
          for (let j = 0; j < c; j++) {
            let s = 0;
            for (let t = 0; t < k; t++) s += A[i][t] * B[t][j];
            out[i][j] = s;
          }
        }
        return out;
      }

      function mulMatVec(A, v) {
        const r = A.length, c = A[0].length;
        const out = Array(r).fill(0);
        for (let i = 0; i < r; i++) {
          let s = 0;
          for (let j = 0; j < c; j++) s += A[i][j] * v[j];
          out[i] = s;
        }
        return out;
      }

      function fitAffine(points) {
        if (!points || points.length < 3) return null;

        const A = points.map(p => [p.lon, p.lat, 1]);
        const bx = points.map(p => p.x);
        const by = points.map(p => p.y);

        const AT = transpose(A);
        const ATA = mul(AT, A);
        const invATA = invert3x3(ATA);
        if (!invATA) return null;

        const ATbx = mulMatVec(AT, bx);
        const ATby = mulMatVec(AT, by);

        const px = mulMat3Vec3(invATA, ATbx);
        const py = mulMat3Vec3(invATA, ATby);

        return { px, py };
      }

      function latLonToPixel(lat, lon, model) {
        const x = model.px[0] * lon + model.px[1] * lat + model.px[2];
        const y = model.py[0] * lon + model.py[1] * lat + model.py[2];
        return { x, y };
      }

      function setMarkerAtImagePixel(x, y) {
        const nw = img.naturalWidth || 1;
        const rect = img.getBoundingClientRect();
        const sx = rect.width / nw;
        const sy = rect.height / (img.naturalHeight || 1);

        const left = x * sx;
        const top = y * sy;

        const cl = clamp(left, 0, rect.width);
        const ct = clamp(top, 0, rect.height);

        marker.style.left = cl + "px";
        marker.style.top = ct + "px";
        marker.style.display = "block";
      }

      function showNote(text) {
        note.textContent = text;
      }

      function init() {
        const model = fitAffine(controlPoints);
        if (!model) {
          showNote("A t√©rk√©p illeszt√©s nem siker√ºlt (kev√©s vagy hib√°s kontroll pont).");
          return;
        }

        if (!navigator.geolocation) {
          showNote("A b√∂ng√©sz≈ë nem t√°mogatja a helymeghat√°roz√°st, ez√©rt a piros jel√∂l≈ë nem jelenik meg.");
          return;
        }

        navigator.geolocation.getCurrentPosition(
          (pos) => {
            const lat = pos.coords.latitude;
            const lon = pos.coords.longitude;

            const p = latLonToPixel(lat, lon, model);
            setMarkerAtImagePixel(p.x, p.y);

            showNote("Aktu√°lis poz√≠ci√≥ jel√∂lve a t√©rk√©pen.");
          },
          (err) => {
            let msg = "A helymeghat√°roz√°s nem el√©rhet≈ë, ez√©rt a piros jel√∂l≈ë nem jelenik meg.";
            if (err && err.code === 1) msg = "A helymeghat√°roz√°s tiltva van, ez√©rt a piros jel√∂l≈ë nem jelenik meg.";
            if (err && err.code === 2) msg = "A helymeghat√°roz√°s nem √©rhet≈ë el (nincs jel), ez√©rt a piros jel√∂l≈ë nem jelenik meg.";
            if (err && err.code === 3) msg = "A helymeghat√°roz√°s id≈ët√∫ll√©p√©s miatt nem siker√ºlt, ez√©rt a piros jel√∂l≈ë nem jelenik meg.";
            showNote(msg);
          },
          {
            enableHighAccuracy: true,
            maximumAge: 15000,
            timeout: 12000
          }
        );
      }

      if (img.complete) {
        init();
      } else {
        img.addEventListener("load", init);
      }

      let resizeTimer = null;
      window.addEventListener("resize", function () {
        clearTimeout(resizeTimer);
        resizeTimer = setTimeout(function () {
          if (marker.style.display === "block") {
            if (navigator.geolocation) {
              navigator.geolocation.getCurrentPosition(
                (pos) => {
                  const model = fitAffine(controlPoints);
                  if (!model) return;
                  const p = latLonToPixel(pos.coords.latitude, pos.coords.longitude, model);
                  setMarkerAtImagePixel(p.x, p.y);
                },
                () => { },
                { enableHighAccuracy: false, maximumAge: 15000, timeout: 8000 }
              );
            }
          }
        }, 250);
      });
    })();
  </script>
</body>

</html>
